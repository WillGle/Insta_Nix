# NixOS Flake Configuration

## Layout

- flake.nix: inputs and host wiring
- hardware-configuration.nix: hardware settings (autogenerated)
- modules/
  - base.nix: boot, filesystems, locale, core services, nix GC
  - perf.nix: nix settings, zram, power policy, fstrim
  - desktop.nix: Hyprland, SDDM, input method, session vars
  - gpu.nix: amdgpu, Vulkan/VA-API
  - audio.nix: PipeWire, Bluetooth
  - networking.nix: NetworkManager, resolved, firewall
  - users.nix: users, shells, optional TLP sudo rule
  - packages.nix: common apps and utilities
  - gaming.nix: Steam, GameMode, gaming tools
  - fonts.nix: font packages and defaults

## Workflow

- Edit the relevant module.
- Rebuild:
  sudo nixos-rebuild switch --flake /etc/nixos#Think14GRyzen

## Validation

- Dry-run build:
  nix build --no-link --dry-run .#nixosConfigurations.Think14GRyzen.config.system.build.toplevel

## Notes

- Power profiles: powerprofilesctl set performance | balanced | power-saver
- To use TLP instead of power-profiles-daemon, toggle it in modules/perf.nix
